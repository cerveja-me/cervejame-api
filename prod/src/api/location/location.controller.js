'use strict';Object.defineProperty(exports,'__esModule',{value:true});exports.createLocation=createLocation;exports.locationChanged=locationChanged;var _location=require('./location.service');async function createLocation(req,res,next){var _req$body=req.body;const id_device=_req$body.id_device,position_gps=_req$body.position_gps,time=_req$body.time;try{let l=await(0,_location.insertLocation)(id_device,position_gps);try{l.zone=await(0,_location.findZone)(l);l.zone=(0,_location.transformTime)(l.zone,time)}catch(error){res.json(l)}}catch(error){next(error)}}async function locationChanged(req,res,next){const location={id:req.params.id,position_maps:req.body.position_maps||req.body.position_gps,street:req.body.street||'',num:req.body.num||'',complement:req.body.complement||''};try{await(0,_location.updateLocation)(location);try{location.zone=await(0,_location.findZone)(location);// location.zone = transformTime(location.zone,time)
res.json(location)}catch(e){res.json(location)}}catch(error){next(error)}}